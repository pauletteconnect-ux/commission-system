<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StarVapers - Bagikan Produk, Dapatkan Komisi</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js Â∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Âü∫Á°ÄÊ†∑Âºè */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.5;
            padding-top: 60px;
            font-size: 14px;
        }
        
        /* Âä†ËΩΩÂä®Áîª */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2e7d32;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ÂØºËà™Ê†è */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }
        
        .nav-title {
            font-size: 18px;
            font-weight: 700;
            color: #2e7d32;
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .nav-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #2e7d32;
            padding: 5px;
        }
        
        /* ÂàÜÁ±ªÂØºËà™ */
        .categories-nav {
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            background: white;
            z-index: 999;
            padding: 10px 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .categories-nav::-webkit-scrollbar {
            display: none;
        }
        
        .category-btn {
            padding: 8px 15px;
            background: #f0f9f0;
            border: none;
            border-radius: 20px;
            color: #2e7d32;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .category-btn.active {
            background: #2e7d32;
            color: white;
        }
        
        /* ‰∏ªÂÆπÂô® */
        .main-container {
            padding: 80px 15px 80px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* ‰∫ßÂìÅÂàóË°® */
        .product-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: relative;
            cursor: pointer;
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            z-index: 2;
        }
        
        .member-badge {
            background: #ff9800;
            color: white;
        }
        
        .hot-badge {
            background: #e53935;
            color: white;
        }
        
        .product-image-container {
            width: 100%;
            height: 180px;
            overflow: hidden;
        }
        
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .product-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-label {
            font-size: 11px;
            color: #666;
        }
        
        .stat-value {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }
        
        .product-price {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .price-item {
            display: flex;
            flex-direction: column;
        }
        
        .price-label {
            font-size: 11px;
            color: #666;
        }
        
        .price-original {
            font-size: 14px;
            color: #999;
            text-decoration: line-through;
        }
        
        .price-member {
            font-size: 16px;
            font-weight: 700;
            color: #e53935;
        }
        
        .commission-display {
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
        }
        
        .commission-zero {
            background: #f5f5f5;
            color: #666;
        }
        
        .commission-amount {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        /* Â±ïÁ§∫Âå∫ */
        .showcase-container {
            margin-bottom: 30px;
        }
        
        .showcase-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
        }
        
        /* Ê®°ÊÄÅÊ°Ü */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-body {
            padding: 15px;
        }
        
        /* Ë°®ÂçïÊ†∑Âºè */
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
            color: #333;
        }
        
        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #2e7d32;
        }
        
        /* ÊåâÈíÆÊ†∑Âºè */
        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #2e7d32;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1b5e20;
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }
        
        .btn-secondary:hover {
            background: #eee;
        }
        
        .btn-whatsapp {
            background: #25D366;
            color: white;
        }
        
        .btn-whatsapp:hover {
            background: #128C7E;
        }
        
        .btn-commission {
            background: #ff9800;
            color: white;
        }
        
        .btn-commission:hover {
            background: #f57c00;
        }
        
        .mb-10 { margin-bottom: 10px; }
        .mb-15 { margin-bottom: 15px; }
        .mb-20 { margin-bottom: 20px; }
        .mt-10 { margin-top: 10px; }
        .mt-15 { margin-top: 15px; }
        
        /* ÈöêËóèÁ±ª */
        .hidden {
            display: none !important;
        }
        
        /* Â∫ïÈÉ®ÂØºËà™ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #666;
            font-size: 12px;
            padding: 5px;
            cursor: pointer;
            flex: 1;
            transition: color 0.3s;
        }
        
        .nav-item.active {
            color: #2e7d32;
        }
        
        .nav-item .nav-icon {
            font-size: 20px;
            margin-bottom: 3px;
        }
        
        /* ÊµÆÂä®ÊåâÈíÆ */
        .floating-buttons {
            position: fixed;
            bottom: 70px;
            right: 15px;
            display: none;
            flex-direction: column;
            gap: 10px;
            z-index: 999;
        }
        
        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }
        
        .floating-btn:hover {
            transform: scale(1.1);
        }
        
        .floating-btn.like-btn { color: #e91e63; }
        .floating-btn.share-btn { color: #2196f3; }
        .floating-btn.buy-btn { color: #4caf50; }
        .floating-btn.back-btn { color: #666; }
        
        /* ‰Ω£ÈáëÈ°µÈù¢Ê†∑Âºè */
        .commission-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .stat-label-large {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value-large {
            font-size: 20px;
            font-weight: 700;
            color: #2e7d32;
        }
        
        /* Ë°®Ê†ºÊ†∑Âºè */
        .table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .table-header {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            background: #f5f5f5;
            padding: 10px;
            font-weight: 600;
            font-size: 12px;
            color: #666;
        }
        
        .table-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        
        .table-row:last-child {
            border-bottom: none;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3e0;
            color: #ff9800;
        }
        
        .status-paid {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        /* ‰∫ßÂìÅËØ¶ÊÉÖÊ†∑Âºè */
        .product-media {
            margin-bottom: 15px;
        }
        
        .product-main-media {
            width: 100%;
            height: 250px;
            overflow: hidden;
        }
        
        .product-main-image, .product-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .thumbnail-strip {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            margin-top: 10px;
        }
        
        .thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s;
        }
        
        .thumbnail.active {
            opacity: 1;
            border: 2px solid #2e7d32;
        }
        
        .product-detail-info {
            padding: 15px;
        }
        
        .product-detail-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .product-description {
            color: #666;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .product-specs {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .spec-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .spec-label {
            color: #666;
        }
        
        .spec-value {
            font-weight: 600;
        }
        
        .detail-images {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .detail-image {
            width: 100%;
            border-radius: 8px;
        }
        
        /* ÁÆ°ÁêÜÂëòÈ°µÈù¢Ê†∑Âºè */
        .admin-tabs {
            display: flex;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 5px;
            margin-bottom: 20px;
        }
        
        .admin-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .admin-tab.active {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .admin-tab-content {
            margin-top: 20px;
        }
        
        /* Êï∞ÊçÆÂàÜÊûêÊ†∑Âºè */
        .time-filter {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
        }
        
        .time-btn {
            padding: 8px 15px;
            background: #f5f5f5;
            border: none;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .time-btn.active {
            background: #2e7d32;
            color: white;
        }
        
        .date-range {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card-sm {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .stat-label-sm {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-value-sm {
            font-size: 18px;
            font-weight: 700;
            color: #333;
        }
        
        .chart-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            height: 300px;
        }
        
        .chart-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        
        .product-stats-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        
        .table-scroll {
            overflow-x: auto;
        }
        
        .product-stats-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .product-stats-table th {
            background: #f5f5f5;
            padding: 12px 15px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            white-space: nowrap;
        }
        
        .product-stats-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        
        .stat-cell {
            font-weight: 600;
            text-align: center;
        }
        
        .view-btn {
            padding: 6px 12px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }
        
        /* ÁªüËÆ°ËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü */
        .stat-detail-modal .modal-content {
            max-width: 600px;
        }
        
        .timeline-item {
            display: grid;
            grid-template-columns: 40px 100px 80px 1fr;
            gap: 10px;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .timeline-icon {
            font-size: 20px;
        }
        
        .timeline-time {
            font-size: 12px;
            color: #666;
        }
        
        .timeline-type {
            font-size: 11px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            text-align: center;
        }
        
        .type-view { background: #e3f2fd; color: #1976d2; }
        .type-click { background: #f3e5f5; color: #7b1fa2; }
        .type-share { background: #e8f5e9; color: #388e3c; }
        .type-like { background: #fce4ec; color: #c2185b; }
        .type-purchase { background: #fff3e0; color: #f57c00; }
        
        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .commission-stats {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .timeline-item {
                grid-template-columns: 40px 80px 70px 1fr;
                font-size: 12px;
            }
            
            .table-header,
            .table-row {
                grid-template-columns: 1fr 1fr 1fr 1fr;
            }
            
            .table-header div:nth-child(3),
            .table-row div:nth-child(3) {
                display: none;
            }
        }
        
        @media (max-width: 480px) {
            .modal-content {
                max-height: 90vh;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .timeline-item {
                grid-template-columns: 40px 70px 60px 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Âä†ËΩΩÂä®Áîª -->
    <div id="loading">
        <div class="spinner"></div>
        <p style="margin-top: 15px; color: #666;">Memuat...</p>
    </div>
    
    <!-- ÂØºËà™Ê†è -->
    <div class="navbar">
        <div class="nav-title">StarVapers</div>
        <div class="nav-right">
            <button class="nav-btn" id="commissionBtn">üí∞</button>
            <button class="nav-btn" id="adminBtn">üîß</button>
        </div>
    </div>
    
    <!-- ÂàÜÁ±ªÂØºËà™ -->
    <div class="categories-nav" id="categoriesNav">
        <!-- ÈÄöËøáJSÂä®ÊÄÅÂä†ËΩΩ -->
    </div>
    
    <!-- ‰∏ªÈ°µ -->
    <div id="homePage" class="main-container">
        <!-- ‰ºöÂëò‰∏ìÂ±ûÂ±ïÁ§∫ -->
        <div class="showcase-container">
            <div class="showcase-title">üéÅ Eksklusif Member / Member Exclusive</div>
            <div class="product-card" id="memberShowcase">
                <!-- ÈÄöËøáJSÂä®ÊÄÅÂä†ËΩΩ -->
                <div style="text-align: center; padding: 50px 20px; color: #666;">
                    <p>Memuat produk eksklusif...</p>
                </div>
            </div>
        </div>
        
        <!-- ÁÉ≠ÂçñÂ±ïÁ§∫ -->
        <div class="showcase-container">
            <div class="showcase-title">üî• Hot Sale / Laris</div>
            <div class="product-card" id="hotSaleShowcase">
                <!-- ÈÄöËøáJSÂä®ÊÄÅÂä†ËΩΩ -->
                <div style="text-align: center; padding: 50px 20px; color: #666;">
                    <p>Memuat produk hot sale...</p>
                </div>
            </div>
        </div>
        
        <!-- ‰∫ßÂìÅÂàóË°® -->
        <div class="showcase-container">
            <div class="showcase-title">üõí Semua Produk / All Products</div>
            <div class="product-list" id="productList">
                <!-- ÈÄöËøáJSÂä®ÊÄÅÂä†ËΩΩ -->
                <div style="text-align: center; padding: 50px 20px; color: #666;">
                    <p>Memuat daftar produk...</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ‰Ω£ÈáëÈ°µÈù¢ -->
    <div id="commissionPage" class="main-container hidden">
        <div style="margin-bottom: 20px;">
            <h2 style="font-size: 20px; margin-bottom: 5px; color: #333;">üí∞ Komisi Saya / My Commission</h2>
            <p style="color: #666; font-size: 14px;">Lacak dan kelola komisi Anda / Track and manage your commission</p>
        </div>
        
        <!-- ‰Ω£ÈáëÁªüËÆ° -->
        <div class="commission-stats" id="commissionStats">
            <div class="stat-card">
                <div class="stat-label-large">Total Komisi / Total Commission</div>
                <div class="stat-value-large">Rp 0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label-large">Pending / Menunggu</div>
                <div class="stat-value-large">Rp 0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label-large">Sudah Dibayar / Paid</div>
                <div class="stat-value-large">Rp 0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label-large">Jumlah Referral / Referral Count</div>
                <div class="stat-value-large">0</div>
            </div>
        </div>
        
        <!-- ‰Ω£ÈáëËÆ∞ÂΩï -->
        <div class="table-container">
            <div class="table-header">
                <div>Produk / Product</div>
                <div>Jumlah / Amount</div>
                <div>Komisi / Commission</div>
                <div>Status</div>
                <div>Tanggal / Date</div>
            </div>
            <div id="commissionRecords">
                <div style="text-align: center; padding: 30px; color: #666;">
                    <p>Belum ada riwayat komisi. / No commission history yet.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ÁÆ°ÁêÜÂëòÈ°µÈù¢ -->
    <div id="adminPage" class="main-container hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="font-size: 20px; color: #333;">üîß Admin Dashboard</h2>
            <button class="btn btn-secondary" id="logoutAdminBtn" style="width: auto; padding: 8px 15px;">
                Logout
            </button>
        </div>
        
        <!-- ÁÆ°ÁêÜÂëòÊ†áÁ≠æÈ°µ -->
        <div class="admin-tabs">
            <div class="admin-tab active" data-tab="orders">Pesanan / Orders</div>
            <div class="admin-tab" data-tab="analytics">Analitik / Analytics</div>
        </div>
        
        <!-- ËÆ¢ÂçïÁÆ°ÁêÜ -->
        <div id="adminOrders" class="admin-tab-content">
            <div class="commission-stats">
                <div class="stat-card">
                    <div class="stat-label-large">Total Penjualan / Total Sales</div>
                    <div class="stat-value-large">Rp 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Total Komisi / Total Commission</div>
                    <div class="stat-value-large">Rp 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Jumlah Pengguna / User Count</div>
                    <div class="stat-value-large">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Jumlah Pesanan / Order Count</div>
                    <div class="stat-value-large">0</div>
                </div>
            </div>
            
            <div style="margin-top: 30px;">
                <h3 style="margin-bottom: 15px; color: #333;">Instruksi Admin / Admin Instructions</h3>
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px;">
                    <p style="margin-bottom: 10px; color: #666;"><strong>1. Tambahkan WhatsApp ke Pesanan / Add WhatsApp to Orders:</strong></p>
                    <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                        Buka Google Sheets ‚Üí Orders sheet ‚Üí Tambahkan nomor WhatsApp di kolom "SharerWhatsApp"
                    </p>
                    
                    <p style="margin-bottom: 10px; color: #666;"><strong>2. Kirim Password ke Pengguna / Send Password to Users:</strong></p>
                    <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                        Buka Google Sheets ‚Üí Users sheet ‚Üí Isi kolom "Password" dan ubah "HasCommission" ke TRUE
                    </p>
                    
                    <p style="margin-bottom: 10px; color: #666;"><strong>3. Kelola Produk / Manage Products:</strong></p>
                    <p style="font-size: 13px; color: #666;">
                        Buka Google Sheets ‚Üí Products sheet ‚Üí Ubah "IsVisible" ke TRUE/FALSE untuk menampilkan/sembunyikan produk
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Êï∞ÊçÆÂàÜÊûê -->
        <div id="adminAnalytics" class="admin-tab-content hidden">
            <!-- Êó∂Èó¥Á≠õÈÄâ -->
            <div class="time-filter">
                <button class="time-btn active" data-range="1d">1 Hari / Day</button>
                <button class="time-btn" data-range="7d">7 Hari / Days</button>
                <button class="time-btn" data-range="30d">30 Hari / Days</button>
                <button class="time-btn" data-range="90d">90 Hari / Days</button>
            </div>
            
            <!-- Êó•ÊúüËåÉÂõ¥ÈÄâÊã© -->
            <div class="date-range">
                <div>
                    <label style="display: block; font-size: 13px; margin-bottom: 5px;">Mulai / Start Date</label>
                    <input type="date" class="form-input" id="startDate">
                </div>
                <div>
                    <label style="display: block; font-size: 13px; margin-bottom: 5px;">Selesai / End Date</label>
                    <input type="date" class="form-input" id="endDate">
                </div>
            </div>
            <button class="btn btn-primary mb-20" id="applyDateRange" style="width: 100%;">
                Terapkan Rentang Tanggal / Apply Date Range
            </button>
            
            <!-- ÁªüËÆ°Ê¶ÇËßà -->
            <div id="statsOverview" class="stats-grid">
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Exposure / Paparan</div>
                    <div class="stat-value-sm">0</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Clicks / Klik</div>
                    <div class="stat-value-sm">0</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Shares / Bagikan</div>
                    <div class="stat-value-sm">0</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Likes / Suka</div>
                    <div class="stat-value-sm">0</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Purchases / Pembelian</div>
                    <div class="stat-value-sm">0</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Click Rate (CTR)</div>
                    <div class="stat-value-sm">0%</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Share Rate</div>
                    <div class="stat-value-sm">0%</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Conversion Rate</div>
                    <div class="stat-value-sm">0%</div>
                </div>
            </div>
            
            <!-- ÊØèÊó•ÁªüËÆ°ÂõæË°® -->
            <div class="chart-container">
                <div class="chart-title">üìä Statistik Harian / Daily Statistics</div>
                <canvas id="dailyChart"></canvas>
            </div>
            
            <!-- ‰∫íÂä®ÂàÜÂ∏ÉÂõæË°® -->
            <div class="chart-container">
                <div class="chart-title">üéØ Distribusi Interaksi / Interaction Distribution</div>
                <canvas id="interactionChart"></canvas>
            </div>
            
            <!-- ËΩ¨ÂåñÁéáÂõæË°® -->
            <div class="chart-container">
                <div class="chart-title">üìà Tingkat Konversi / Conversion Rates</div>
                <canvas id="conversionChart"></canvas>
            </div>
            
            <!-- ÁÉ≠Èó®‰∫ßÂìÅÂõæË°® -->
            <div class="chart-container">
                <div class="chart-title">üèÜ Produk Terpopuler / Top Products</div>
                <canvas id="topProductsChart"></canvas>
            </div>
            
            <!-- ‰∫ßÂìÅÁªüËÆ°Ë°®Ê†º -->
            <div class="product-stats-table">
                <div class="table-scroll">
                    <table>
                        <thead>
                            <tr>
                                <th>Produk / Product</th>
                                <th>Exposure / Paparan</th>
                                <th>Clicks / Klik</th>
                                <th>Shares / Bagikan</th>
                                <th>Likes / Suka</th>
                                <th>Purchases / Pembelian</th>
                                <th>CTR</th>
                                <th>Conversion</th>
                                <th>Aksi / Action</th>
                            </tr>
                        </thead>
                        <tbody id="productStatsBody">
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 20px; color: #666;">
                                    Tidak ada data statistik / No statistics data available
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ÊµÆÂä®ÊåâÈíÆÔºàÁî®‰∫é‰∫ßÂìÅËØ¶ÊÉÖÈ°µÔºâ -->
    <div class="floating-buttons" id="floatingButtons">
        <button class="floating-btn like-btn" id="likeBtn">‚ù§Ô∏è</button>
        <button class="floating-btn share-btn" id="shareBtn">üì§</button>
        <button class="floating-btn buy-btn" id="buyBtn">üí¨</button>
        <button class="floating-btn back-btn" id="backBtn">‚Ü©Ô∏è</button>
    </div>
    
    <!-- Â∫ïÈÉ®ÂØºËà™ -->
    <div class="bottom-nav">
        <div class="nav-item active" data-page="home">
            <span class="nav-icon">üè†</span>
            <span>Beranda / Home</span>
        </div>
        <div class="nav-item" id="shareNavBtn">
            <span class="nav-icon">üì§</span>
            <span>Bagikan / Share</span>
        </div>
        <div class="nav-item" data-page="commission">
            <span class="nav-icon">üí∞</span>
            <span>Komisi / Commission</span>
        </div>
        <div class="nav-item" id="helpBtn">
            <span class="nav-icon">‚ùì</span>
            <span>Bantuan / Help</span>
        </div>
    </div>

    <!-- WhatsAppÂè∑Á†ÅËæìÂÖ•Ê®°ÊÄÅÊ°Ü -->
    <div class="modal" id="whatsappModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üì± Nomor WhatsApp / WhatsApp Number</h2>
                <button class="close-btn" id="closeWhatsappModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mb-15">
                    <p style="color: #666; font-size: 14px; line-height: 1.5;">
                        Nomor WhatsApp ini akan menjadi <strong>identitas unik</strong> dan <strong>dasar perhitungan komisi</strong>.
                        Pastikan memasukkan nomor WhatsApp yang benar.
                    </p>
                    <p style="color: #666; font-size: 14px; line-height: 1.5; margin-top: 10px;">
                        This WhatsApp number will be your <strong>unique identity</strong> and <strong>basis for commission calculation</strong>.
                        Please enter the correct WhatsApp number.
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Nomor WhatsApp / WhatsApp Number</label>
                    <input type="tel" class="form-input" id="whatsappInput" 
                           placeholder="Contoh / Example: 62812345678"
                           pattern="[0-9]{10,15}"
                           required>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        Format: 62xxxxxxxxxx (tanpa +, spasi, atau tanda hubung / without +, spaces, or hyphens)
                    </small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Konfirmasi / Confirm</label>
                    <input type="tel" class="form-input" id="whatsappConfirm" 
                           placeholder="Masukkan ulang nomor / Re-enter number"
                           pattern="[0-9]{10,15}"
                           required>
                </div>
                
                <button class="btn btn-whatsapp mb-10" id="saveWhatsappBtn">
                    üíæ Simpan & Lanjutkan / Save & Continue
                </button>
                <button class="btn btn-secondary" id="skipWhatsappBtn">
                    Lewati / Skip (tidak dapat komisi / no commission)
                </button>
            </div>
        </div>
    </div>

    <!-- ‰Ω£ÈáëÁôªÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="commissionLoginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üîê Login Komisi / Commission Login</h2>
                <button class="close-btn" id="closeCommissionLogin">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mb-15">
                    <p style="color: #666; font-size: 14px;">
                        Masukkan nomor WhatsApp dan password untuk melihat komisi Anda.
                        Password akan dikirim via WhatsApp ketika Anda memiliki komisi.
                    </p>
                    <p style="color: #666; font-size: 14px; margin-top: 5px;">
                        Enter your WhatsApp number and password to view your commission.
                        Password will be sent via WhatsApp when you have commission.
                    </p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Nomor WhatsApp / WhatsApp Number</label>
                    <input type="tel" class="form-input" id="loginWhatsapp" 
                           placeholder="62812345678"
                           value="">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" 
                           placeholder="Masukkan password / Enter password">
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        Password dikirim via WhatsApp saat ada komisi / Password sent via WhatsApp when commission available
                    </small>
                </div>
                
                <div id="loginMessage" style="display: none; padding: 10px; border-radius: 6px; margin-bottom: 15px;"></div>
                
                <button class="btn btn-primary mb-10" id="submitCommissionLogin">
                    üîì Login & Lihat Komisi / Login & View Commission
                </button>
                <button class="btn btn-secondary" id="forgotPasswordBtn">
                    Lupa Password? / Forgot Password?
                </button>
            </div>
        </div>
    </div>

    <!-- ÁÆ°ÁêÜÂëòÁôªÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="adminLoginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üîê Admin Login</h2>
                <button class="close-btn" id="closeAdminLogin">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="adminUsername" 
                           placeholder="Enter username">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="adminPassword" 
                           placeholder="Enter password">
                </div>
                
                <div id="adminLoginMessage" style="display: none; padding: 10px; border-radius: 6px; margin-bottom: 15px;"></div>
                
                <button class="btn btn-primary" id="submitAdminLogin">
                    Login
                </button>
            </div>
        </div>
    </div>

    <!-- ‰∫ßÂìÅËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="productDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="productDetailTitle">Product Details</h2>
                <button class="close-btn" id="closeProductDetail">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div id="productDetailContent">
                    <div style="text-align: center; padding: 50px 20px; color: #666;">
                        <p>Memuat detail produk...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂàÜ‰∫´Èù¢ÊùøÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="shareModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">üì§ Bagikan Produk / Share Product</h2>
                <button class="close-btn" id="closeShareModal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="shareProductInfo" class="mb-20">
                    <div style="text-align: center;">
                        <p style="font-weight: 600; font-size: 16px; margin-bottom: 5px;">Product Name</p>
                        <p style="color: #666; font-size: 14px;">Komisi yang bisa didapat / Commission available:</p>
                    </div>
                </div>
                
                <div class="mb-15">
                    <p style="color: #666; font-size: 14px; text-align: center;">
                        Komisi yang akan Anda dapatkan: 
                        <span id="shareCommissionAmount" style="color: #ff9800; font-weight: 700;">Rp 0</span>
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <button class="btn btn-whatsapp" id="shareViaWhatsapp">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <span>üì±</span>
                            <span>WhatsApp</span>
                        </div>
                    </button>
                    <button class="btn btn-secondary" id="copyShareLink">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <span>üîó</span>
                            <span>Salin Link / Copy Link</span>
                        </div>
                    </button>
                </div>
                
                <div class="mt-15" style="padding: 10px; background: #f9f9f9; border-radius: 6px;">
                    <p style="font-size: 12px; color: #666; margin: 0;">
                        <strong>Info:</strong> Link berisi nomor WhatsApp Anda untuk tracking komisi.
                        <strong>Note:</strong> Link contains your WhatsApp number for commission tracking.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Â∏ÆÂä©/ÂÆ¢ÊúçÊ®°ÊÄÅÊ°Ü -->
    <div class="modal" id="helpModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">‚ùì Bantuan & Dukungan / Help & Support</h2>
                <button class="close-btn" id="closeHelpModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mb-15">
                    <h3 style="font-size: 16px; margin-bottom: 10px; color: #333;">Kontak Support / Support Contact</h3>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding: 10px; background: #f9f9f9; border-radius: 6px;">
                        <span style="font-size: 24px;">üì±</span>
                        <div>
                            <p style="font-weight: 600; margin: 0; color: #333;">WhatsApp Support</p>
                            <p style="font-size: 14px; color: #666; margin: 2px 0 0 0;">6286215621230</p>
                        </div>
                    </div>
                </div>
                
                <div class="mb-15">
                    <h3 style="font-size: 16px; margin-bottom: 10px; color: #333;">FAQ / Pertanyaan Umum</h3>
                    <div style="font-size: 14px; color: #666;">
                        <p><strong>Q: Kapan komisi dibayar? / When is commission paid?</strong></p>
                        <p>A: Komisi dibayar setelah order selesai dan diverifikasi. / Commission paid after order completed and verified.</p>
                        
                        <p class="mt-10"><strong>Q: Bagaimana cara login? / How to login?</strong></p>
                        <p>A: Password akan dikirim via WhatsApp saat Anda memiliki komisi. / Password will be sent via WhatsApp when you have commission.</p>
                    </div>
                </div>
                
                <button class="btn btn-whatsapp" id="contactSupportBtn">
                    üí¨ Hubungi via WhatsApp / Contact via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============= ÈÖçÁΩÆ =============
        const CONFIG = {
            API_URL: 'https://tranquil-gumption-9a7e64.netlify.app/.netlify/functions/api',
            SUPPORT_WHATSAPP: '6286215621230',
            ADMIN_USERNAME: 'admin',
            ADMIN_PASSWORD: 'admin123'
        };
        
        // ============= ÂÖ®Â±ÄÂèòÈáè =============
        let products = [];
        let categories = [];
        let currentProduct = null;
        let currentUser = {
            whatsapp: null,
            deviceId: null,
            isAuthenticated: false,
            hasCommission: false
        };
        let isAdmin = false;
        let charts = {
            dailyChart: null,
            interactionChart: null,
            conversionChart: null,
            topProductsChart: null
        };
        
        // ============= È°µÈù¢ÂàùÂßãÂåñ =============
        document.addEventListener('DOMContentLoaded', async function() {
            // ÈöêËóèÂä†ËΩΩÂä®Áîª
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
            }, 1000);
            
            // ÂàùÂßãÂåñÁî®Êà∑Ë∫´‰ªΩ
            await initializeUser();
            
            // Ê£ÄÊü•URLÂèÇÊï∞
            checkUrlParameters();
            
            // Âä†ËΩΩÊï∞ÊçÆ
            await loadData();
            
            // ËÆæÁΩÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
            setupEventListeners();
            
            // ÊòæÁ§∫‰∏ªÈ°µ
            showPage('home');
        });
        
        // ============= Áî®Êà∑Ë∫´‰ªΩÁÆ°ÁêÜ =============
        async function initializeUser() {
            // ÁîüÊàêÊàñËé∑ÂèñËÆæÂ§áID
            let deviceId = localStorage.getItem('device_id');
            if (!deviceId) {
                deviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('device_id', deviceId);
            }
            currentUser.deviceId = deviceId;
            
            // Ëé∑Âèñ‰øùÂ≠òÁöÑWhatsAppÂè∑Á†Å
            const savedWhatsapp = localStorage.getItem('user_whatsapp');
            if (savedWhatsapp) {
                currentUser.whatsapp = savedWhatsapp;
                currentUser.isAuthenticated = true;
                
                // Ê£ÄÊü•ÊòØÂê¶Êúâ‰Ω£Èáë
                try {
                    const response = await fetch(`${CONFIG.API_URL}?action=getOrCreateUser&whatsapp=${encodeURIComponent(savedWhatsapp)}`);
                    const data = await response.json();
                    if (data.success && data.user) {
                        currentUser.hasCommission = data.user.HasCommission === true;
                    }
                } catch (error) {
                    console.error('Error checking user commission:', error);
                }
            }
            
            // Ê£ÄÊü•ÁÆ°ÁêÜÂëòÁôªÂΩïÁä∂ÊÄÅ
            const adminToken = localStorage.getItem('admin_token');
            if (adminToken === CONFIG.ADMIN_PASSWORD) {
                isAdmin = true;
            }
        }
        
        // ============= Êï∞ÊçÆÂä†ËΩΩ =============
        async function loadData() {
            try {
                console.log('Loading data...');
                
                // Âä†ËΩΩÂàÜÁ±ª
                const categoriesResponse = await fetch(`${CONFIG.API_URL}?action=getCategories`);
                const categoriesData = await categoriesResponse.json();
                console.log('Categories data:', categoriesData);
                
                if (categoriesData.success) {
                    categories = categoriesData.data;
                    renderCategories();
                }
                
                // Âä†ËΩΩ‰∫ßÂìÅ
                const productsResponse = await fetch(`${CONFIG.API_URL}?action=getProducts`);
                const productsData = await productsResponse.json();
                console.log('Products data:', productsData);
                
                if (productsData.success) {
                    products = productsData.data;
                    renderHomePage();
                } else {
                    console.error('Failed to load products:', productsData);
                }
            } catch (error) {
                console.error('Error loading data:', error);
                showError('Gagal memuat data. / Failed to load data.');
            }
        }
        
        // ============= È°µÈù¢Ê∏≤Êüì =============
        function renderCategories() {
            const categoriesNav = document.getElementById('categoriesNav');
            if (!categoriesNav) return;
            
            let html = '';
            html += `<button class="category-btn active" data-category="all">Semua / All</button>`;
            
            if (categories && categories.length > 0) {
                categories.forEach(category => {
                    html += `<button class="category-btn" data-category="${category.ID}">${category.Name}</button>`;
                });
            }
            
            categoriesNav.innerHTML = html;
            
            // Ê∑ªÂä†ÂàÜÁ±ªÁÇπÂáª‰∫ã‰ª∂
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const categoryId = this.dataset.category;
                    if (categoryId === 'all') {
                        renderProductList(products);
                    } else {
                        const filteredProducts = products.filter(p => p.CategoryID == categoryId);
                        renderProductList(filteredProducts);
                    }
                });
            });
        }
        
        function renderHomePage() {
            console.log('Rendering home page with products:', products);
            
            if (!products || products.length === 0) {
                console.warn('No products available');
                return;
            }
            
            // Ê∏≤Êüì‰ºöÂëò‰∏ìÂ±û‰∫ßÂìÅ
            const memberProduct = products.find(p => p.IsMemberExclusive === true && p.IsVisible !== false);
            const memberShowcase = document.getElementById('memberShowcase');
            if (memberProduct && memberShowcase) {
                memberShowcase.innerHTML = `
                    <div class="member-badge product-badge">MEMBER EKSKLUSIF / EXCLUSIVE</div>
                    <div class="product-image-container">
                        <img src="${memberProduct.ImageURL || 'https://via.placeholder.com/300x180?text=No+Image'}" alt="${memberProduct.Name}" class="product-image">
                    </div>
                    <div class="product-info">
                        <div class="product-name">${memberProduct.Name}</div>
                        <div class="product-stats">
                            <div class="stat-item">
                                <span class="stat-label">Terjual / Sold</span>
                                <span class="stat-value">${memberProduct.PurchasedCount || 0}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Stok / Stock</span>
                                <span class="stat-value">${memberProduct.StockCount || 0}</span>
                            </div>
                        </div>
                        <div class="product-price">
                            <div class="price-item">
                                <span class="price-label">Harga / Price</span>
                                <span class="price-original">Rp ${memberProduct.OriginalPrice || 0}</span>
                            </div>
                            <div class="price-item">
                                <span class="price-label">Member / VIP</span>
                                <span class="price-member">Rp ${memberProduct.MemberPrice || 0}</span>
                            </div>
                        </div>
                        <div class="commission-display commission-zero">
                            Komisi / Commission: 0
                        </div>
                    </div>
                `;
                
                memberShowcase.style.cursor = 'pointer';
                memberShowcase.addEventListener('click', () => showProductDetail(memberProduct.ID));
            }
            
            // Ê∏≤ÊüìÁÉ≠Âçñ‰∫ßÂìÅ
            const hotProduct = products.find(p => p.IsHotSale === true && p.IsVisible !== false);
            const hotSaleShowcase = document.getElementById('hotSaleShowcase');
            if (hotProduct && hotSaleShowcase) {
                hotSaleShowcase.innerHTML = `
                    <div class="hot-badge product-badge">HOT SALE</div>
                    <div class="product-image-container">
                        <img src="${hotProduct.ImageURL || 'https://via.placeholder.com/300x180?text=No+Image'}" alt="${hotProduct.Name}" class="product-image">
                    </div>
                    <div class="product-info">
                        <div class="product-name">${hotProduct.Name}</div>
                        <div class="product-stats">
                            <div class="stat-item">
                                <span class="stat-label">Terjual / Sold</span>
                                <span class="stat-value">${hotProduct.PurchasedCount || 0}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Stok / Stock</span>
                                <span class="stat-value">${hotProduct.StockCount || 0}</span>
                            </div>
                        </div>
                        <div class="product-price">
                            <div class="price-item">
                                <span class="price-label">Harga / Price</span>
                                <span class="price-original">Rp ${hotProduct.OriginalPrice || 0}</span>
                            </div>
                            <div class="price-item">
                                <span class="price-label">Member / VIP</span>
                                <span class="price-member">Rp ${hotProduct.MemberPrice || 0}</span>
                            </div>
                        </div>
                        <div class="commission-display commission-amount">
                            Komisi / Commission: Rp ${hotProduct.Commission || 0}
                        </div>
                    </div>
                `;
                
                hotSaleShowcase.style.cursor = 'pointer';
                hotSaleShowcase.addEventListener('click', () => showProductDetail(hotProduct.ID));
            }
            
            // Ê∏≤Êüì‰∫ßÂìÅÂàóË°®
            const regularProducts = products.filter(p => 
                p.IsMemberExclusive !== true && 
                p.IsHotSale !== true && 
                p.IsVisible !== false
            );
            
            renderProductList(regularProducts);
        }
        
        function renderProductList(productList) {
            const productListContainer = document.getElementById('productList');
            if (!productListContainer) return;
            
            if (!productList || productList.length === 0) {
                productListContainer.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: #666;">
                        <p>Tidak ada produk tersedia. / No products available.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            productList.forEach(product => {
                // Á°ÆÂÆöÂæΩÁ´†
                let badge = '';
                if (product.IsMemberExclusive === true) {
                    badge = '<div class="member-badge product-badge">MEMBER</div>';
                } else if (product.IsHotSale === true) {
                    badge = '<div class="hot-badge product-badge">HOT</div>';
                }
                
                // Á°ÆÂÆö‰Ω£ÈáëÊòæÁ§∫
                let commissionDisplay = '';
                if (product.IsMemberExclusive === true) {
                    commissionDisplay = '<div class="commission-display commission-zero">Komisi / Commission: 0</div>';
                } else if (product.Commission > 0) {
                    commissionDisplay = `<div class="commission-display commission-amount">Komisi / Commission: Rp ${product.Commission}</div>`;
                }
                
                html += `
                    <div class="product-card" data-id="${product.ID}">
                        ${badge}
                        <div class="product-image-container">
                            <img src="${product.ImageURL || 'https://via.placeholder.com/300x180?text=No+Image'}" alt="${product.Name}" class="product-image">
                        </div>
                        <div class="product-info">
                            <div class="product-name">${product.Name}</div>
                            <div class="product-stats">
                                <div class="stat-item">
                                    <span class="stat-label">Terjual / Sold</span>
                                    <span class="stat-value">${product.PurchasedCount || 0}</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Stok / Stock</span>
                                    <span class="stat-value">${product.StockCount || 0}</span>
                                </div>
                            </div>
                            <div class="product-price">
                                <div class="price-item">
                                    <span class="price-label">Harga / Price</span>
                                    <span class="price-original">Rp ${product.OriginalPrice || 0}</span>
                                </div>
                                <div class="price-item">
                                    <span class="price-label">Member / VIP</span>
                                    <span class="price-member">Rp ${product.MemberPrice || 0}</span>
                                </div>
                            </div>
                            ${commissionDisplay}
                        </div>
                    </div>
                `;
            });
            
            productListContainer.innerHTML = html;
            
            // ËÆ∞ÂΩï‰∫ßÂìÅÊõùÂÖâÁªüËÆ°ÔºàÂª∂ËøüÊâßË°åÔºâ
            setTimeout(() => {
                productList.forEach(product => {
                    recordProductStat(product.ID, 'view');
                });
            }, 1000);
            
            // Ê∑ªÂä†‰∫ßÂìÅÁÇπÂáª‰∫ã‰ª∂
            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('click', function() {
                    const productId = parseInt(this.dataset.id);
                    showProductDetail(productId);
                });
            });
        }
        
        // ============= ‰∫ßÂìÅÁªüËÆ°ÂäüËÉΩ =============
        async function recordProductStat(productId, statType) {
            try {
                const response = await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'recordProductStat',
                        productId: productId,
                        statType: statType,
                        deviceId: currentUser.deviceId,
                        whatsapp: currentUser.whatsapp
                    })
                });
                
                const data = await response.json();
                return data.success;
            } catch (error) {
                console.error('Error recording product stat:', error);
                return false;
            }
        }
        
        // ============= ‰∫ßÂìÅËØ¶ÊÉÖ =============
        async function showProductDetail(productId) {
            // ËÆ∞ÂΩïÁÇπÂáªÁªüËÆ°
            await recordProductStat(productId, 'click');
            
            currentProduct = products.find(p => p.ID === productId);
            if (!currentProduct) {
                alert('Produk tidak ditemukan. / Product not found.');
                return;
            }
            
            // ÊòæÁ§∫‰∫ßÂìÅËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü
            const modal = document.getElementById('productDetailModal');
            const content = document.getElementById('productDetailContent');
            const title = document.getElementById('productDetailTitle');
            
            title.textContent = currentProduct.Name;
            
            // Êî∂ÈõÜÊâÄÊúâÂõæÁâá
            const images = [];
            if (currentProduct.ImageURL) images.push(currentProduct.ImageURL);
            if (currentProduct.ImageURL2) images.push(currentProduct.ImageURL2);
            if (currentProduct.ImageURL3) images.push(currentProduct.ImageURL3);
            if (currentProduct.ImageURL4) images.push(currentProduct.ImageURL4);
            if (currentProduct.ImageURL5) images.push(currentProduct.ImageURL5);
            
            // ÊûÑÂª∫ËØ¶ÊÉÖHTML
            let html = `
                <div class="product-media">
                    <div class="product-main-media">
                        ${currentProduct.VideoURL ? 
                            `<video class="product-video" controls poster="${currentProduct.ImageURL || ''}">
                                <source src="${currentProduct.VideoURL}" type="video/mp4">
                                Browser tidak mendukung video. / Browser doesn't support video.
                            </video>` :
                            `<img src="${currentProduct.ImageURL || 'https://via.placeholder.com/400x250?text=No+Image'}" alt="${currentProduct.Name}" class="product-main-image">`
                        }
                    </div>
                    
                    ${images.length > 1 ? `
                    <div class="thumbnail-strip">
                        ${images.map((img, index) => `
                            <img src="${img}" alt="Thumbnail ${index + 1}" 
                                 class="thumbnail ${index === 0 ? 'active' : ''}"
                                 data-index="${index}"
                                 onclick="changeMainImage(${index})">
                        `).join('')}
                    </div>
                    ` : ''}
                </div>
                
                <div class="product-detail-info">
                    <h2 class="product-detail-name">${currentProduct.Name}</h2>
                    
                    ${currentProduct.Description ? `
                    <div class="product-description">
                        ${currentProduct.Description}
                    </div>
                    ` : ''}
                    
                    <div class="product-specs">
                        <div class="spec-item">
                            <span class="spec-label">Terjual / Sold:</span>
                            <span class="spec-value">${currentProduct.PurchasedCount || 0}</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Stok / Stock:</span>
                            <span class="spec-value">${currentProduct.StockCount || 0}</span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Komisi / Commission:</span>
                            <span class="spec-value" style="color: ${currentProduct.IsMemberExclusive ? '#666' : '#ff9800'};">
                                ${currentProduct.IsMemberExclusive ? '0' : `Rp ${currentProduct.Commission || 0}`}
                            </span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Harga Asli / Original Price:</span>
                            <span class="spec-value" style="text-decoration: line-through; color: #999;">
                                Rp ${currentProduct.OriginalPrice || 0}
                            </span>
                        </div>
                        <div class="spec-item">
                            <span class="spec-label">Harga Member / VIP Price:</span>
                            <span class="spec-value" style="color: #e53935; font-weight: 700;">
                                Rp ${currentProduct.MemberPrice || 0}
                            </span>
                        </div>
                    </div>
                    
                    ${images.length > 1 ? `
                    <div class="detail-images">
                        ${images.slice(1).map((img, index) => `
                            <img src="${img}" alt="${currentProduct.Name} - ${index + 2}" class="detail-image">
                        `).join('')}
                    </div>
                    ` : ''}
                    
                    <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <button class="btn btn-whatsapp" onclick="consultProduct()">
                            üí¨ Konsultasi / Consult
                        </button>
                        <button class="btn btn-commission" onclick="showShareModal()">
                            üì§ Bagikan & Dapatkan Komisi / Share & Earn Commission
                        </button>
                    </div>
                </div>
            `;
            
            content.innerHTML = html;
            modal.style.display = 'flex';
            
            // ÊòæÁ§∫ÊµÆÂä®ÊåâÈíÆ
            document.getElementById('floatingButtons').style.display = 'flex';
        }
        
        // ============= ÂàÜ‰∫´ÂäüËÉΩ =============
        async function showShareModal() {
            if (!currentProduct) return;
            
            // Ê£ÄÊü•ÊòØÂê¶ÊúâWhatsAppÂè∑Á†Å
            if (!currentUser.whatsapp) {
                // ÊòæÁ§∫WhatsAppÂè∑Á†ÅËæìÂÖ•Ê°Ü
                showWhatsappModal();
                return;
            }
            
            const modal = document.getElementById('shareModal');
            const productInfo = document.getElementById('shareProductInfo');
            const commissionAmount = document.getElementById('shareCommissionAmount');
            
            // ËÆ°ÁÆó‰Ω£Èáë
            const commission = currentProduct.IsMemberExclusive ? 0 : (currentProduct.Commission || 0);
            
            productInfo.innerHTML = `
                <div style="text-align: center;">
                    <p style="font-weight: 600; font-size: 16px; margin-bottom: 5px;">${currentProduct.Name}</p>
                    <p style="color: #666; font-size: 14px;">Komisi yang bisa didapat / Commission available:</p>
                </div>
            `;
            
            commissionAmount.textContent = `Rp ${commission}`;
            
            modal.style.display = 'flex';
            
            // ËÆæÁΩÆÂàÜ‰∫´ÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('shareViaWhatsapp').onclick = () => shareProductViaWhatsapp();
            document.getElementById('copyShareLink').onclick = () => copyShareLink();
        }
        
        async function shareProductViaWhatsapp() {
            if (!currentProduct || !currentUser.whatsapp) return;
            
            const commission = currentProduct.IsMemberExclusive ? 0 : (currentProduct.Commission || 0);
            
            // ÁîüÊàêÂàÜ‰∫´ÈìæÊé•
            const baseUrl = window.location.origin + window.location.pathname;
            const shareUrl = `${baseUrl}?product=${currentProduct.ID}&ref=${currentUser.whatsapp}`;
            
            // ÂàõÂª∫ÂàÜ‰∫´Ê∂àÊÅØ
            let message = `üî• ${currentProduct.Name} üî•\n\n`;
            message += `üíµ Harga Asli / Original Price: Rp ${currentProduct.OriginalPrice}\n`;
            message += `üí∞ Harga Member / VIP Price: Rp ${currentProduct.MemberPrice}\n`;
            if (commission > 0) {
                message += `üéØ Komisi yang bisa didapat / Commission available: Rp ${commission}\n\n`;
            }
            message += `üëá Klik link untuk lihat detail / Click link for details:\n`;
            message += `${shareUrl}\n\n`;
            message += `üì± Dibagikan dari / Shared from WhatsApp: ${currentUser.whatsapp}`;
            
            // ÁºñÁ†ÅÊ∂àÊÅØÂπ∂ÊâìÂºÄWhatsApp
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');
            
            // ËÆ∞ÂΩïÂàÜ‰∫´ÁªüËÆ°
            await recordProductStat(currentProduct.ID, 'share');
            
            // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('shareModal').style.display = 'none';
        }
        
        async function copyShareLink() {
            if (!currentProduct || !currentUser.whatsapp) return;
            
            const baseUrl = window.location.origin + window.location.pathname;
            const shareUrl = `${baseUrl}?product=${currentProduct.ID}&ref=${currentUser.whatsapp}`;
            
            try {
                await navigator.clipboard.writeText(shareUrl);
                alert('Link berhasil disalin! / Link copied successfully!');
                
                // ËÆ∞ÂΩïÊ¥ªÂä®
                await recordProductStat(currentProduct.ID, 'share');
                
                // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
                document.getElementById('shareModal').style.display = 'none';
            } catch (error) {
                alert('Gagal menyalin link. / Failed to copy link.');
            }
        }
        
        // ============= WhatsAppÂè∑Á†ÅÁÆ°ÁêÜ =============
        function showWhatsappModal() {
            const modal = document.getElementById('whatsappModal');
            modal.style.display = 'flex';
            
            // Ê∏ÖÁ©∫ËæìÂÖ•Ê°Ü
            document.getElementById('whatsappInput').value = '';
            document.getElementById('whatsappConfirm').value = '';
        }
        
        async function saveWhatsappNumber() {
            const whatsappInput = document.getElementById('whatsappInput').value.trim();
            const whatsappConfirm = document.getElementById('whatsappConfirm').value.trim();
            
            // È™åËØÅËæìÂÖ•
            if (!whatsappInput || !whatsappConfirm) {
                alert('Harap isi kedua kolom. / Please fill both fields.');
                return;
            }
            
            if (whatsappInput !== whatsappConfirm) {
                alert('Nomor WhatsApp tidak cocok. / WhatsApp numbers do not match.');
                return;
            }
            
            // È™åËØÅÊ†ºÂºè (Âç∞Â∞ºÂè∑Á†Å)
            if (!/^62\d{9,13}$/.test(whatsappInput)) {
                alert('Format nomor WhatsApp tidak valid. Gunakan format 62xxxxxxxxxx / Invalid WhatsApp number format. Use 62xxxxxxxxxx');
                return;
            }
            
            // ‰øùÂ≠òÂà∞Êú¨Âú∞Â≠òÂÇ®
            localStorage.setItem('user_whatsapp', whatsappInput);
            currentUser.whatsapp = whatsappInput;
            currentUser.isAuthenticated = true;
            
            // ÂèëÈÄÅÂà∞ÂêéÁ´ØËÆ∞ÂΩïÁî®Êà∑
            try {
                await fetch(`${CONFIG.API_URL}?action=getOrCreateUser&whatsapp=${encodeURIComponent(whatsappInput)}`);
                await logActivity('whatsapp_registered', `WhatsApp terdaftar: ${whatsappInput}`, currentUser.deviceId, whatsappInput);
            } catch (error) {
                console.error('Error registering user:', error);
            }
            
            // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            document.getElementById('whatsappModal').style.display = 'none';
            
            // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
            alert('Nomor WhatsApp berhasil disimpan! / WhatsApp number saved successfully!');
            
            // Â¶ÇÊûúÊòØ‰ªéÂàÜ‰∫´Ëß¶ÂèëÁöÑÔºåÈáçÊñ∞ÊâìÂºÄÂàÜ‰∫´Ê®°ÊÄÅÊ°Ü
            if (currentProduct) {
                setTimeout(() => showShareModal(), 500);
            }
        }
        
        // ============= ‰Ω£ÈáëÁÆ°ÁêÜ =============
        function showCommissionPage() {
            if (!currentUser.whatsapp) {
                // Â¶ÇÊûúÊ≤°ÊúâWhatsAppÂè∑Á†ÅÔºåË¶ÅÊ±ÇËæìÂÖ•
                showWhatsappModal();
                return;
            }
            
            if (!currentUser.hasCommission) {
                // Â¶ÇÊûúÊ≤°Êúâ‰Ω£ÈáëÔºåÊòæÁ§∫ÁôªÂΩïÊ®°ÊÄÅÊ°Ü
                showCommissionLoginModal();
                return;
            }
            
            // ÊòæÁ§∫‰Ω£ÈáëÈ°µÈù¢
            showPage('commission');
            loadCommissionData();
        }
        
        function showCommissionLoginModal() {
            const modal = document.getElementById('commissionLoginModal');
            const loginWhatsapp = document.getElementById('loginWhatsapp');
            
            // Â¶ÇÊûúÊú¨Âú∞Êúâ‰øùÂ≠òÁöÑWhatsAppÂè∑Á†ÅÔºåËá™Âä®Â°´ÂÖÖ
            if (currentUser.whatsapp) {
                loginWhatsapp.value = currentUser.whatsapp;
            }
            
            modal.style.display = 'flex';
        }
        
        async function verifyCommissionLogin() {
            const whatsapp = document.getElementById('loginWhatsapp').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const messageDiv = document.getElementById('loginMessage');
            
            if (!whatsapp || !password) {
                showMessage(messageDiv, 'Harap isi semua kolom. / Please fill all fields.', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${CONFIG.API_URL}?action=verifyLogin&whatsapp=${encodeURIComponent(whatsapp)}&password=${encodeURIComponent(password)}`);
                const data = await response.json();
                
                if (data.success) {
                    // ÁôªÂΩïÊàêÂäü
                    localStorage.setItem('user_whatsapp', whatsapp);
                    currentUser.whatsapp = whatsapp;
                    currentUser.isAuthenticated = true;
                    currentUser.hasCommission = true;
                    
                    // ÂÖ≥Èó≠ÁôªÂΩïÊ®°ÊÄÅÊ°Ü
                    document.getElementById('commissionLoginModal').style.display = 'none';
                    
                    // ÊòæÁ§∫‰Ω£ÈáëÈ°µÈù¢
                    showPage('commission');
                    loadCommissionData();
                    
                    showMessage(messageDiv, 'Login berhasil! / Login successful!', 'success');
                } else {
                    // ÁôªÂΩïÂ§±Ë¥•
                    let errorMsg = 'Login gagal. / Login failed.';
                    if (data.message && data.message.includes('no commission')) {
                        errorMsg = 'Belum ada komisi. Password akan dikirim via WhatsApp saat Anda memiliki komisi. / No commission yet. Password will be sent via WhatsApp when you have commission.';
                    } else if (data.message && data.message.includes('not found')) {
                        errorMsg = 'Nomor WhatsApp tidak ditemukan. / WhatsApp number not found.';
                    } else if (data.message && data.message.includes('Incorrect password')) {
                        errorMsg = 'Password salah. Hubungi support jika lupa password. / Incorrect password. Contact support if forgot password.';
                    }
                    
                    showMessage(messageDiv, errorMsg, 'error');
                }
            } catch (error) {
                console.error('Login error:', error);
                showMessage(messageDiv, 'Terjadi kesalahan. Coba lagi. / An error occurred. Try again.', 'error');
            }
        }
        
        async function loadCommissionData() {
            if (!currentUser.whatsapp) return;
            
            try {
                const response = await fetch(`${CONFIG.API_URL}?action=getUserCommissions&whatsapp=${encodeURIComponent(currentUser.whatsapp)}`);
                const data = await response.json();
                
                if (data.success) {
                    renderCommissionStats(data);
                    renderCommissionRecords(data.commissions || []);
                } else {
                    document.getElementById('commissionStats').innerHTML = `
                        <div style="text-align: center; padding: 30px; color: #666;">
                            <p>Tidak ada data komisi. / No commission data.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading commission data:', error);
                document.getElementById('commissionStats').innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #666;">
                        <p>Gagal memuat data komisi. / Failed to load commission data.</p>
                    </div>
                `;
            }
        }
        
        function renderCommissionStats(data) {
            const statsContainer = document.getElementById('commissionStats');
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label-large">Total Komisi / Total Commission</div>
                    <div class="stat-value-large">Rp ${data.totalCommission || 0}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Pending / Menunggu</div>
                    <div class="stat-value-large">Rp ${data.pendingCommission || 0}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Sudah Dibayar / Paid</div>
                    <div class="stat-value-large">Rp ${data.paidCommission || 0}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label-large">Jumlah Referral / Referral Count</div>
                    <div class="stat-value-large">${data.referralCount || 0}</div>
                </div>
            `;
        }
        
        function renderCommissionRecords(commissions) {
            const recordsContainer = document.getElementById('commissionRecords');
            
            if (!commissions || commissions.length === 0) {
                recordsContainer.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #666;">
                        <p>Belum ada riwayat komisi. / No commission history yet.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            commissions.forEach(record => {
                const statusClass = record.Status === 'paid' ? 'status-paid' : 'status-pending';
                const statusText = record.Status === 'paid' ? 'Dibayar / Paid' : 'Pending / Menunggu';
                const date = record.CreatedAt ? new Date(record.CreatedAt).toLocaleDateString('id-ID') : '-';
                
                html += `
                    <div class="table-row">
                        <div>${record.ProductID || '-'}</div>
                        <div>Rp ${record.Amount || 0}</div>
                        <div>Rp ${record.Commission || 0}</div>
                        <div><span class="status-badge ${statusClass}">${statusText}</span></div>
                        <div>${date}</div>
                    </div>
                `;
            });
            
            recordsContainer.innerHTML = html;
        }
        
        // ============= ÁÆ°ÁêÜÂëòÂäüËÉΩ =============
        function showAdminLoginModal() {
            const modal = document.getElementById('adminLoginModal');
            modal.style.display = 'flex';
        }
        
        function verifyAdminLogin() {
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            const messageDiv = document.getElementById('adminLoginMessage');
            
            if (username === CONFIG.ADMIN_USERNAME && password === CONFIG.ADMIN_PASSWORD) {
                // ÁôªÂΩïÊàêÂäü
                localStorage.setItem('admin_token', password);
                isAdmin = true;
                
                // ÂÖ≥Èó≠ÁôªÂΩïÊ®°ÊÄÅÊ°Ü
                document.getElementById('adminLoginModal').style.display = 'none';
                
                // ÊòæÁ§∫ÁÆ°ÁêÜÂëòÈ°µÈù¢
                showPage('admin');
                loadAdminData();
                
                showMessage(messageDiv, 'Login berhasil! / Login successful!', 'success');
            } else {
                showMessage(messageDiv, 'Username atau password salah. / Incorrect username or password.', 'error');
            }
        }
        
        async function loadAdminData() {
            try {
                const response = await fetch(`${CONFIG.API_URL}?action=getAdminStats`);
                const data = await response.json();
                
                if (data.success) {
                    renderAdminOrders(data);
                }
            } catch (error) {
                console.error('Error loading admin data:', error);
            }
        }
        
        function renderAdminOrders(data) {
            const ordersContainer = document.getElementById('adminOrders');
            
            ordersContainer.innerHTML = `
                <div class="commission-stats">
                    <div class="stat-card">
                        <div class="stat-label-large">Total Penjualan / Total Sales</div>
                        <div class="stat-value-large">Rp ${data.totalSales || 0}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label-large">Total Komisi / Total Commission</div>
                        <div class="stat-value-large">Rp ${data.totalCommission || 0}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label-large">Jumlah Pengguna / User Count</div>
                        <div class="stat-value-large">${data.userCount || 0}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label-large">Jumlah Pesanan / Order Count</div>
                        <div class="stat-value-large">${data.orderCount || 0}</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px; color: #333;">Instruksi Admin / Admin Instructions</h3>
                    <div style="background: #f9f9f9; padding: 15px; border-radius: 8px;">
                        <p style="margin-bottom: 10px; color: #666;"><strong>1. Tambahkan WhatsApp ke Pesanan / Add WhatsApp to Orders:</strong></p>
                        <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                            Buka Google Sheets ‚Üí Orders sheet ‚Üí Tambahkan nomor WhatsApp di kolom "SharerWhatsApp"
                        </p>
                        
                        <p style="margin-bottom: 10px; color: #666;"><strong>2. Kirim Password ke Pengguna / Send Password to Users:</strong></p>
                        <p style="font-size: 13px; color: #666; margin-bottom: 15px;">
                            Buka Google Sheets ‚Üí Users sheet ‚Üí Isi kolom "Password" dan ubah "HasCommission" ke TRUE
                        </p>
                        
                        <p style="margin-bottom: 10px; color: #666;"><strong>3. Kelola Produk / Manage Products:</strong></p>
                        <p style="font-size: 13px; color: #666;">
                            Buka Google Sheets ‚Üí Products sheet ‚Üí Ubah "IsVisible" ke TRUE/FALSE untuk menampilkan/sembunyikan produk
                        </p>
                    </div>
                </div>
            `;
        }
        
        // ============= Êï∞ÊçÆÂàÜÊûêÂäüËÉΩ =============
        async function loadAnalyticsData(timeRange = '7d', startDate = null, endDate = null) {
            try {
                const payload = { action: 'getStatsSummary', timeRange: timeRange };
                if (startDate && endDate) {
                    payload.startDate = startDate;
                    payload.endDate = endDate;
                }
                
                const response = await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                if (data.success) {
                    renderAnalytics(data.data);
                    renderProductStatsTable(data.data.productStats);
                } else {
                    console.error('Failed to load analytics data');
                    document.getElementById('statsOverview').innerHTML = `
                        <div style="text-align: center; padding: 30px; color: #666; grid-column: 1 / -1;">
                            <p>Gagal memuat data analitik. / Failed to load analytics data.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }
        
        function renderAnalytics(data) {
            const statsOverview = document.getElementById('statsOverview');
            if (!statsOverview) return;
            
            const { summary, rates } = data;
            
            statsOverview.innerHTML = `
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Exposure / Paparan</div>
                    <div class="stat-value-sm">${summary.totalViews || 0}</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Clicks / Klik</div>
                    <div class="stat-value-sm">${summary.totalClicks || 0}</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Shares / Bagikan</div>
                    <div class="stat-value-sm">${summary.totalShares || 0}</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Likes / Suka</div>
                    <div class="stat-value-sm">${summary.totalLikes || 0}</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Total Purchases / Pembelian</div>
                    <div class="stat-value-sm">${summary.totalPurchases || 0}</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Click Rate (CTR)</div>
                    <div class="stat-value-sm">${rates.clickToViewRate || 0}%</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Share Rate</div>
                    <div class="stat-value-sm">${rates.shareToClickRate || 0}%</div>
                </div>
                <div class="stat-card-sm">
                    <div class="stat-label-sm">Conversion Rate</div>
                    <div class="stat-value-sm">${rates.purchaseToShareRate || 0}%</div>
                </div>
            `;
            
            // Ê∏≤ÊüìÂõæË°®
            renderCharts(data);
        }
        
        function renderCharts(data) {
            // ÈîÄÊØÅÁé∞ÊúâÂõæË°®
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            
            // ÊØèÊó•ÁªüËÆ°ÂõæË°®
            renderDailyChart(data.dailyStats || []);
            
            // ‰∫íÂä®ÂàÜÂ∏ÉÂõæË°®
            renderInteractionChart(data.summary || {});
            
            // ËΩ¨ÂåñÁéáÂõæË°®
            renderConversionChart(data.rates || {});
            
            // ÁÉ≠Èó®‰∫ßÂìÅÂõæË°®
            renderTopProductsChart(data.productStats || {});
        }
        
        function renderDailyChart(dailyStats) {
            const ctx = document.getElementById('dailyChart');
            if (!ctx) return;
            
            const labels = dailyStats.map(stat => {
                const date = new Date(stat.date);
                return `${date.getDate()}/${date.getMonth() + 1}`;
            });
            
            const viewsData = dailyStats.map(stat => stat.views || 0);
            const clicksData = dailyStats.map(stat => stat.clicks || 0);
            const sharesData = dailyStats.map(stat => stat.shares || 0);
            
            charts.dailyChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Exposure / Paparan',
                            data: viewsData,
                            borderColor: '#2196f3',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Clicks / Klik',
                            data: clicksData,
                            borderColor: '#9c27b0',
                            backgroundColor: 'rgba(156, 39, 176, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Shares / Bagikan',
                            data: sharesData,
                            borderColor: '#4caf50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function renderInteractionChart(summary) {
            const ctx = document.getElementById('interactionChart');
            if (!ctx) return;
            
            const data = [
                summary.totalViews || 0,
                summary.totalClicks || 0,
                summary.totalShares || 0,
                summary.totalLikes || 0,
                summary.totalPurchases || 0
            ];
            
            charts.interactionChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Exposure / Paparan', 'Clicks / Klik', 'Shares / Bagikan', 'Likes / Suka', 'Purchases / Pembelian'],
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            '#2196f3',
                            '#9c27b0',
                            '#4caf50',
                            '#ff9800',
                            '#f44336'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function renderConversionChart(rates) {
            const ctx = document.getElementById('conversionChart');
            if (!ctx) return;
            
            charts.conversionChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Click to View', 'Share to Click', 'Purchase to Share'],
                    datasets: [{
                        label: 'Rate (%)',
                        data: [
                            parseFloat(rates.clickToViewRate || 0),
                            parseFloat(rates.shareToClickRate || 0),
                            parseFloat(rates.purchaseToShareRate || 0)
                        ],
                        backgroundColor: [
                            'rgba(33, 150, 243, 0.7)',
                            'rgba(156, 39, 176, 0.7)',
                            'rgba(76, 175, 80, 0.7)'
                        ],
                        borderColor: [
                            '#2196f3',
                            '#9c27b0',
                            '#4caf50'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y}%`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function renderTopProductsChart(productStats) {
            const ctx = document.getElementById('topProductsChart');
            if (!ctx) return;
            
            // ËΩ¨Êç¢‰∏∫Êï∞ÁªÑÂπ∂ÊéíÂ∫è
            const productsArray = Object.values(productStats)
                .sort((a, b) => (b.views || 0) - (a.views || 0))
                .slice(0, 5);
            
            const labels = productsArray.map(p => {
                const name = p.productName || `Product ${p.productId}`;
                return name.length > 20 ? name.substring(0, 20) + '...' : name;
            });
            
            charts.topProductsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Exposure / Paparan',
                        data: productsArray.map(p => p.views || 0),
                        backgroundColor: 'rgba(33, 150, 243, 0.7)'
                    }, {
                        label: 'Clicks / Klik',
                        data: productsArray.map(p => p.clicks || 0),
                        backgroundColor: 'rgba(156, 39, 176, 0.7)'
                    }, {
                        label: 'Purchases / Pembelian',
                        data: productsArray.map(p => p.purchases || 0),
                        backgroundColor: 'rgba(76, 175, 80, 0.7)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: false,
                        },
                        y: {
                            stacked: false,
                            beginAtZero: true
                        }
                    }
                }
            });
        }
        
        function renderProductStatsTable(productStats) {
            const tbody = document.getElementById('productStatsBody');
            if (!tbody) return;
            
            if (!productStats || Object.keys(productStats).length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 20px; color: #666;">
                            Tidak ada data statistik / No statistics data available
                        </td>
                    </tr>
                `;
                return;
            }
            
            let html = '';
            
            Object.values(productStats).forEach(stat => {
                const views = stat.views || 0;
                const clicks = stat.clicks || 0;
                const shares = stat.shares || 0;
                const purchases = stat.purchases || 0;
                
                const ctr = views > 0 ? ((clicks / views) * 100).toFixed(2) : 0;
                const conversion = shares > 0 ? ((purchases / shares) * 100).toFixed(2) : 0;
                
                html += `
                    <tr>
                        <td>
                            <strong>${stat.productName || `Product ${stat.productId}`}</strong>
                            ${stat.categoryId ? `<br><small>Category: ${stat.categoryId}</small>` : ''}
                        </td>
                        <td class="stat-cell">${views}</td>
                        <td class="stat-cell">${clicks}</td>
                        <td class="stat-cell">${shares}</td>
                        <td class="stat-cell">${stat.likes || 0}</td>
                        <td class="stat-cell">${purchases}</td>
                        <td class="stat-cell">${ctr}%</td>
                        <td class="stat-cell">${conversion}%</td>
                        <td>
                            <button class="view-btn" onclick="showProductDetailStats(${stat.productId})">
                                Detail
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
        }
        
        async function showProductDetailStats(productId) {
            try {
                const response = await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'getProductDetailStats',
                        productId: productId
                    })
                });
                
                const data = await response.json();
                if (data.success) {
                    renderProductDetailModal(data.data);
                }
            } catch (error) {
                console.error('Error loading product detail stats:', error);
                alert('Gagal memuat detail statistik. / Failed to load statistics details.');
            }
        }
        
        function renderProductDetailModal(data) {
            const { productInfo, stats } = data;
            
            // ÂàõÂª∫Ê®°ÊÄÅÊ°Ü
            const modal = document.createElement('div');
            modal.className = 'modal stat-detail-modal';
            modal.style.display = 'flex';
            
            const timelineItems = (stats.timeline || []).map(item => `
                <div class="timeline-item">
                    <div class="timeline-icon">
                        ${getTimelineIcon(item.type)}
                    </div>
                    <div class="timeline-time">
                        ${formatDateTime(item.timestamp)}
                    </div>
                    <div class="timeline-type type-${item.type}">
                        ${item.type.toUpperCase()}
                    </div>
                    <div class="timeline-details">
                        ${item.whatsapp ? `WhatsApp: ${item.whatsapp}` : ''}
                    </div>
                </div>
            `).join('');
            
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">üìä Detail Statistik: ${productInfo.Name}</h2>
                        <button class="close-btn" onclick="this.closest('.modal').style.display='none'">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="product-info-section">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                <div>
                                    <p><strong>Harga / Price:</strong> Rp ${productInfo.MemberPrice || 0}</p>
                                    <p><strong>Komisi / Commission:</strong> Rp ${productInfo.Commission || 0}</p>
                                </div>
                                <div>
                                    <p><strong>Stok / Stock:</strong> ${productInfo.StockCount || 0}</p>
                                    <p><strong>Terjual / Sold:</strong> ${productInfo.PurchasedCount || 0}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stats-summary">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                <div class="stat-card-sm">
                                    <div class="stat-label-sm">Exposure</div>
                                    <div class="stat-value-sm">${stats.views || 0}</div>
                                </div>
                                <div class="stat-card-sm">
                                    <div class="stat-label-sm">Clicks</div>
                                    <div class="stat-value-sm">${stats.clicks || 0}</div>
                                </div>
                                <div class="stat-card-sm">
                                    <div class="stat-label-sm">Shares</div>
                                    <div class="stat-value-sm">${stats.shares || 0}</div>
                                </div>
                                <div class="stat-card-sm">
                                    <div class="stat-label-sm">Likes</div>
                                    <div class="stat-value-sm">${stats.likes || 0}</div>
                                </div>
                                <div class="stat-card-sm">
                                    <div class="stat-label-sm">Purchases</div>
                                    <div class="stat-value-sm">${stats.purchases || 0}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="conversion-rates">
                            <h3>Tingkat Konversi / Conversion Rates</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px;">
                                    <p style="margin: 0; font-size: 12px; color: #666;">CTR (Click Through Rate)</p>
                                    <p style="margin: 5px 0 0 0; font-size: 20px; font-weight: 700; color: #2196f3;">
                                        ${stats.views > 0 ? ((stats.clicks / stats.views) * 100).toFixed(2) : 0}%
                                    </p>
                                </div>
                                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px;">
                                    <p style="margin: 0; font-size: 12px; color: #666;">Share Rate</p>
                                    <p style="margin: 5px 0 0 0; font-size: 20px; font-weight: 700; color: #9c27b0;">
                                        ${stats.clicks > 0 ? ((stats.shares / stats.clicks) * 100).toFixed(2) : 0}%
                                    </p>
                                </div>
                                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px;">
                                    <p style="margin: 0; font-size: 12px; color: #666;">Conversion Rate</p>
                                    <p style="margin: 5px 0 0 0; font-size: 20px; font-weight: 700; color: #4caf50;">
                                        ${stats.shares > 0 ? ((stats.purchases / stats.shares) * 100).toFixed(2) : 0}%
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-timeline">
                            <h3>Timeline Aktivitas / Activity Timeline</h3>
                            <div style="margin-top: 15px;">
                                ${timelineItems || '<p style="text-align: center; color: #666; padding: 20px;">No activity data / Tidak ada data aktivitas</p>'}
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    document.body.removeChild(this);
                }
            });
        }
        
        // ============= Â∑•ÂÖ∑ÂáΩÊï∞ =============
        function showPage(page) {
            // ÈöêËóèÊâÄÊúâÈ°µÈù¢
            document.getElementById('homePage').classList.add('hidden');
            document.getElementById('commissionPage').classList.add('hidden');
            document.getElementById('adminPage').classList.add('hidden');
            
            // ÈöêËóèÊµÆÂä®ÊåâÈíÆ
            document.getElementById('floatingButtons').style.display = 'none';
            
            // ÊòæÁ§∫ÁõÆÊ†áÈ°µÈù¢
            document.getElementById(page + 'Page').classList.remove('hidden');
            
            // Êõ¥Êñ∞Â∫ïÈÉ®ÂØºËà™ÊøÄÊ¥ªÁä∂ÊÄÅ
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.dataset.page === page) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // Êõ¥Êñ∞ÂàÜÁ±ªÂØºËà™ÂèØËßÅÊÄß
            if (page === 'home') {
                document.getElementById('categoriesNav').style.display = 'flex';
            } else {
                document.getElementById('categoriesNav').style.display = 'none';
            }
            
            // Â¶ÇÊûúÊòØÂàÜÊûêÈ°µÈù¢‰∏îÊòØÁÆ°ÁêÜÂëòÔºåÂä†ËΩΩÊï∞ÊçÆ
            if (page === 'admin') {
                setTimeout(() => {
                    const activeTab = document.querySelector('.admin-tab.active');
                    if (activeTab && activeTab.dataset.tab === 'analytics' && isAdmin) {
                        loadAnalyticsData('7d');
                    }
                }, 100);
            }
        }
        
        function showMessage(container, message, type) {
            container.textContent = message;
            container.style.display = 'block';
            container.style.backgroundColor = type === 'success' ? '#e8f5e9' : '#ffebee';
            container.style.color = type === 'success' ? '#2e7d32' : '#e53935';
            container.style.border = type === 'success' ? '1px solid #c8e6c9' : '1px solid #ffcdd2';
            
            // 3ÁßíÂêéÈöêËóèÊ∂àÊÅØ
            setTimeout(() => {
                container.style.display = 'none';
            }, 3000);
        }
        
        function showError(message) {
            alert(message);
        }
        
        function checkUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('product');
            const ref = urlParams.get('ref');
            
            if (productId) {
                // Â¶ÇÊûúÊúâ‰∫ßÂìÅIDÔºåÊòæÁ§∫‰∫ßÂìÅËØ¶ÊÉÖ
                setTimeout(() => {
                    showProductDetail(parseInt(productId));
                }, 1000);
            }
            
            if (ref) {
                // Â¶ÇÊûúÊúâÊé®ËçêÁ†ÅÔºå‰øùÂ≠òÂà∞localStorage
                localStorage.setItem('referral_code', ref);
            }
        }
        
        async function logActivity(type, message, deviceId, whatsapp) {
            try {
                await fetch(CONFIG.API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'logActivity',
                        type: type,
                        message: message,
                        deviceId: deviceId,
                        whatsapp: whatsapp,
                        data: {
                            productId: currentProduct ? currentProduct.ID : null,
                            timestamp: new Date().toISOString()
                        }
                    })
                });
            } catch (error) {
                console.error('Error logging activity:', error);
            }
        }
        
        function consultProduct() {
            if (!currentProduct) return;
            
            const message = `Halo, saya ingin konsultasi tentang produk: ${currentProduct.Name}. Harga: Rp ${currentProduct.MemberPrice}. Apakah ada stok?`;
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${CONFIG.SUPPORT_WHATSAPP}?text=${encodedMessage}`, '_blank');
        }
        
        function contactSupport() {
            const message = 'Halo, saya butuh bantuan mengenai sistem komisi.';
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/${CONFIG.SUPPORT_WHATSAPP}?text=${encodedMessage}`, '_blank');
        }
        
        function getTimelineIcon(type) {
            switch(type) {
                case 'view': return 'üëÅÔ∏è';
                case 'click': return 'üñ±Ô∏è';
                case 'share': return 'üì§';
                case 'like': return '‚ù§Ô∏è';
                case 'purchase': return 'üí∞';
                default: return 'üìù';
            }
        }
        
        function formatDateTime(timestamp) {
            const date = new Date(timestamp);
            return `${date.getDate()}/${date.getMonth() + 1} ${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
        }
        
        // ============= ÂÖ®Â±ÄÂáΩÊï∞ =============
        window.changeMainImage = function(index) {
            const thumbnails = document.querySelectorAll('.thumbnail');
            const mainMedia = document.querySelector('.product-main-media');
            
            // Êõ¥Êñ∞Áº©Áï•ÂõæÊøÄÊ¥ªÁä∂ÊÄÅ
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
            
            // Êõ¥Êñ∞‰∏ªÂõæ
            const imageUrl = thumbnails[index].src;
            if (mainMedia.querySelector('video')) {
                mainMedia.innerHTML = `
                    <img src="${imageUrl}" alt="${currentProduct.Name}" class="product-main-image">
                `;
            } else {
                mainMedia.querySelector('.product-main-image').src = imageUrl;
            }
        };
        
        window.showProductDetailStats = showProductDetailStats;
        
        // ============= ‰∫ã‰ª∂ÁõëÂê¨Âô®ËÆæÁΩÆ =============
        function setupEventListeners() {
            // Â∫ïÈÉ®ÂØºËà™
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    if (this.id === 'shareNavBtn') {
                        // ÂàÜ‰∫´ÊåâÈíÆ
                        if (currentProduct) {
                            showShareModal();
                        } else {
                            alert('Pilih produk terlebih dahulu untuk dibagikan. / Select a product first to share.');
                        }
                    } else if (this.id === 'helpBtn') {
                        // Â∏ÆÂä©ÊåâÈíÆ
                        document.getElementById('helpModal').style.display = 'flex';
                    } else {
                        // È°µÈù¢ÂàáÊç¢
                        const page = this.dataset.page;
                        if (page === 'commission') {
                            showCommissionPage();
                        } else {
                            showPage(page);
                        }
                    }
                });
            });
            
            // È°∂ÈÉ®ÊåâÈíÆ
            document.getElementById('commissionBtn').addEventListener('click', showCommissionPage);
            document.getElementById('adminBtn').addEventListener('click', () => {
                if (isAdmin) {
                    showPage('admin');
                } else {
                    showAdminLoginModal();
                }
            });
            
            // WhatsAppÂè∑Á†ÅÊ®°ÊÄÅÊ°Ü
            document.getElementById('saveWhatsappBtn').addEventListener('click', saveWhatsappNumber);
            document.getElementById('skipWhatsappBtn').addEventListener('click', () => {
                document.getElementById('whatsappModal').style.display = 'none';
                alert('Anda dapat membagikan produk, tetapi tidak akan menerima komisi. / You can share products, but will not receive commission.');
            });
            document.getElementById('closeWhatsappModal').addEventListener('click', () => {
                document.getElementById('whatsappModal').style.display = 'none';
            });
            
            // ‰Ω£ÈáëÁôªÂΩïÊ®°ÊÄÅÊ°Ü
            document.getElementById('submitCommissionLogin').addEventListener('click', verifyCommissionLogin);
            document.getElementById('closeCommissionLogin').addEventListener('click', () => {
                document.getElementById('commissionLoginModal').style.display = 'none';
            });
            document.getElementById('forgotPasswordBtn').addEventListener('click', () => {
                alert('Hubungi support via WhatsApp untuk reset password. / Contact support via WhatsApp to reset password.');
                contactSupport();
            });
            
            // ÁÆ°ÁêÜÂëòÁôªÂΩïÊ®°ÊÄÅÊ°Ü
            document.getElementById('submitAdminLogin').addEventListener('click', verifyAdminLogin);
            document.getElementById('closeAdminLogin').addEventListener('click', () => {
                document.getElementById('adminLoginModal').style.display = 'none';
            });
            
            // ‰∫ßÂìÅËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü
            document.getElementById('closeProductDetail').addEventListener('click', () => {
                document.getElementById('productDetailModal').style.display = 'none';
                document.getElementById('floatingButtons').style.display = 'none';
            });
            
            // ÂàÜ‰∫´Ê®°ÊÄÅÊ°Ü
            document.getElementById('closeShareModal').addEventListener('click', () => {
                document.getElementById('shareModal').style.display = 'none';
            });
            
            // Â∏ÆÂä©Ê®°ÊÄÅÊ°Ü
            document.getElementById('closeHelpModal').addEventListener('click', () => {
                document.getElementById('helpModal').style.display = 'none';
            });
            document.getElementById('contactSupportBtn').addEventListener('click', contactSupport);
            
            // ÊµÆÂä®ÊåâÈíÆ
            document.getElementById('likeBtn').addEventListener('click', async () => {
                if (currentProduct) {
                    await recordProductStat(currentProduct.ID, 'like');
                    alert('Produk ditambahkan ke favorit! / Product added to favorites!');
                }
            });
            document.getElementById('shareBtn').addEventListener('click', showShareModal);
            document.getElementById('buyBtn').addEventListener('click', consultProduct);
            document.getElementById('backBtn').addEventListener('click', () => {
                document.getElementById('productDetailModal').style.display = 'none';
                document.getElementById('floatingButtons').style.display = 'none';
            });
            
            // ÁÆ°ÁêÜÂëòÊ†áÁ≠æÈ°µ
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.admin-tab-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    
                    const tabId = this.dataset.tab;
                    const targetId = 'admin' + tabId.charAt(0).toUpperCase() + tabId.slice(1);
                    document.getElementById(targetId).classList.remove('hidden');
                    
                    // Â¶ÇÊûúÊòØÂàÜÊûêÈ°µÈù¢ÔºåÂä†ËΩΩÊï∞ÊçÆ
                    if (tabId === 'analytics' && isAdmin) {
                        loadAnalyticsData('7d');
                    }
                });
            });
            
            // ÁÆ°ÁêÜÂëòÁôªÂá∫
            document.getElementById('logoutAdminBtn').addEventListener('click', () => {
                localStorage.removeItem('admin_token');
                isAdmin = false;
                showPage('home');
                alert('Logged out successfully.');
            });
            
            // Êï∞ÊçÆÂàÜÊûêÈ°µÈù¢‰∫ã‰ª∂
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const timeRange = this.dataset.range;
                    loadAnalyticsData(timeRange);
                });
            });
            
            document.getElementById('applyDateRange').addEventListener('click', function() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                
                if (startDate && endDate) {
                    // ÈáçÁΩÆÊó∂Èó¥ÊåâÈíÆÁä∂ÊÄÅ
                    document.querySelectorAll('.time-btn').forEach(b => b.classList.remove('active'));
                    loadAnalyticsData(null, startDate, endDate);
                } else {
                    alert('Please select both start and end dates. / Harap pilih tanggal mulai dan akhir.');
                }
            });
            
            // Ê®°ÊÄÅÊ°ÜÂ§ñÈÉ®ÁÇπÂáªÂÖ≥Èó≠
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                    }
                });
            });
        }
    </script>
</body>
</html>
